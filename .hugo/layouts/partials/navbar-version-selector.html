{{ if .Site.Params.versions -}}
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
   {{ .Site.Params.version_menu }}
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
   <div id="version-menu-container"></div>
   <script>
     (function() {
        const currentPath = window.location.pathname;
        const projectRoot = "/genai-toolbox/";

        // 3. Logic to convert Current Path -> Target "Latest" Path
        // We want to strip the version segment (/v0.19.1/ or /dev/) to get the path on the 'latest' site.
        // Regex explanation: Match projectRoot, then optionally a version folder (v followed by digits or 'dev'), then the rest.
        // This effectively transforms "/genai-toolbox/v0.19.1/foo" -> "/genai-toolbox/foo"
        let targetPath = currentPath.replace(new RegExp("^" + projectRoot + "(v[0-9.]+|dev)/"), projectRoot);

        // 4. Append the metadata filename
        // Ensure we don't end up with double slashes if at root
        if (targetPath.endsWith("/")) {
            targetPath += "releases.releases";
        } else {
            targetPath += "/releases.releases";
        }

        // 5. Set the include attribute and trigger W3.js
        document.getElementById("version-menu-container").setAttribute("w3-include-html", targetPath);
        w3.includeHTML();
     })();
   </script>
</div>
{{ end -}}